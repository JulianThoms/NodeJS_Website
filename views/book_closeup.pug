extends layout.pug

block title
  title=book.title

block content
  div(class="row justify-content-center")
    h1(class="display-3")=book.title
  div(class="row mt-5 mb-4" style="border-bottom: 1px solid #343A40")
  

  
  div(class="justify-content-center")  
    if !isFavourite
      form(action="/addFavourite" method="post" class="form-group")
        button(type="submit" class="btn btn-block" style="background-color:#34403a; color:white; border: none") Add to Favourites
    if isFavourite
      form(action="/removeFavourite/"+book.id_book+"/book" method="post" class="form-group")
        button(type="submit" class="btn btn-block" style="background-color:#40343a; color:white; border: none") Remove from Favourites
  div(class="row mt-4 mb-2" style="border-bottom: 1px solid #343A40")
  div(class="row my-3 justify-content-between")
    div(class="col-4 d-none d-md-block")
      div(class="row justify-content-center" style="background-color:#343A40; padding-top: 1.25rem")
        div(class="col-12")
          if results != undefined
            img(class="card-img-top", src=""+results.thumbnail , style="width: 9rem")
          else
            img(class="card-img-top", src="/images/no_result.png", style="width: 9rem")
          div(class="card-body" style="padding-bottom: 0")
            div(class="card-text")
              table(class="table table-dark")
                tbody
                  tr
                    th(scope="col") Author
                    td=book.author
                tbody
                  tr
                    th(scope="col") Released
                    td=book.year
                tbody
                  tr
                    th(scope="col") ISBN
                    td=book.isbn
                if averageRating != undefined
                  tbody
                    tr
                      th(scope="col") Average Rating
                          td
                            img(src="/images/star_gold.png" class="star")
                            if averageRating > 1.5
                              img(src="/images/star_gold.png" class="star")
                            if averageRating > 2.5
                              img(src="/images/star_gold.png" class="star")
                            if averageRating > 3.5
                              img(src="/images/star_gold.png" class="star")
                            if averageRating > 4.5
                              img(src="/images/star_gold.png" class="star")
                              
    div(class="col-12 d-block d-md-none")
      div(class="row justify-content-center" style="background-color:#343A40; padding-top: 1.25rem")
        div(class="col-12")
          if results != undefined
            img(class="card-img-top", src=""+results.thumbnail , style="width: 9rem")
          else
            img(class="card-img-top", src="/images/no_result.png", style="width: 9rem")
          div(class="card-body" style="padding-bottom: 0")
            div(class="card-text")
              table(class="table table-dark")
                tbody
                  tr
                    th(scope="col") Author
                    td=book.author
                tbody
                  tr
                    th(scope="col") Released
                    td=book.year
                tbody
                  tr
                    th(scope="col") ISBN
                    td=book.isbn
                if averageRating != undefined
                    tbody
                      tr
                        th(scope="col") Average Rating
                          td
                            img(src="/images/star_gold.png" class="star")
                            if averageRating > 1.5
                              img(src="/images/star_gold.png" class="star")
                            if averageRating > 2.5
                              img(src="/images/star_gold.png" class="star")
                            if averageRating > 3.5
                              img(src="/images/star_gold.png" class="star")
                            if averageRating > 4.5
                              img(src="/images/star_gold.png" class="star")


    div(class="col-1")
    div(class="col d-none d-md-block")
      div(class="row")
        div(class="col-9") 
          h1 What's the book about?
        div(class="col-3")
          a(class="btn btn-block" href="https://www.amazon.de/s?k="+book.isbn  style="background-color:#343A40; color: #eaebeb;  border: none") Amazon
      div(class="row my-4")
        if results != undefined
          p(class="text-justify")=results.description
        else
          p(class="text-justify") No description found :(
      
  div(class="row my-4" style="border-bottom: 1px solid #343A40")

  div(class="row d-none d-sm-block")
    if reviewed
      div(class="display-4 text-muted") You have already reviewed this book!
    else
      div(class="row justify-content-center")
        div(class="col-1")
        div(class="col-9")
          form(action="/addReview" method="post" class="form-group")
            input(type="hidden" value="" name="rating" id="rating_input")
            textarea(type="text" placeholder="Read this book? Write a Review!" name="userReview" maxlength="512" class="form-control" rows="4" style="background-color:#484d53; color:white; border:none" required)
            button(type="submit" class="btn btn-block mt-2" style="background-color:#343A40; color: white; border:none") Submit!
        div(class="col-1")
          div(class="row")
            img(src="/images/star_gray.png" id="star5" class="star")
          div(class="row")
            img(src="/images/star_gray.png" id="star4" class="star")
          div(class="row")
            img(src="/images/star_gray.png" id="star3" class="star")
          div(class="row")
            img(src="/images/star_gray.png" id="star2" class="star")
          div(class="row")
            img(src="/images/star_gray.png" id="star1" class="star")
  div(class="row my-4" style="border-bottom: 1px solid #343A40")
  
  div(class="row justify-content-center")
    div(class="col-12")
      a(class="btn list-group-item list-group-item-action rounded" id="get-review" data-toggle="collapse" href="#get-review-ref" style="background-color:#343A40; color: #eaebeb;  border: none") Read Reviews

  div(class="my-4 col-12 fade collapse clearfix indent" id="get-review-ref" style="border: none")
    if !no_reviews
      each review in reviews
        div(class="card my-2 clearfix" style="width: 100%; background-color:#343A40")
          div(class="card-body float-left")
            h3(class="card-title float-left")=review.name
            div(class="card-title float-right")
              img(src="/images/star_gold.png" class="star")
              if review.rating > 1.5
                img(src="/images/star_gold.png" class="star")
              if review.rating > 2.5
                img(src="/images/star_gold.png" class="star")
              if review.rating > 3.5
                img(src="/images/star_gold.png" class="star")
              if review.rating > 4.5
                img(src="/images/star_gold.png" class="star")
          div(class="card-body")
            h5(class="card-text float-left")=review.review

    else
      div(class="display-3") No Reviews yet!
  div(class="row my-4")

  block script
    script(src="/js/clientside.js")
